
load ../../../Lib/time
load ../../../Lib/soft-agents
load ../../../Lib/cp-e-config
load ../../../Lib/cp-e-rules
load ../../../Lib/pretty
load ../knowledge
load scp
load tasks-wind
load scenario
load sitl


mod TEST is
 inc SITL .
 
 
 op getAct :  ActionKB  -> Action .
 op getKB : ActionKB -> KB .
 
 eq getAct({a:Action,kb:KB}) = a:Action .
 eq getKB({a:Action,kb:KB}) = kb:KB .
 

ops lkb0 lkb1 lkb2  ekb0 : -> KB .
ops akb0 akb1 : -> ActionKB .

eq lkb0 = (clock(3)class(b(0),Bot)class(b(1),Bot)(timeElapsed(5.4363060000000001)@
    2)(rand(2)@ 2)(atloc(b(0),{senLoc(5.6792564690100002e-2,-1.14697972313e-2,
    4.9682731628400001),pt(0,-1,5)})@ 2)(atloc(b(1),{senLoc(0.0,0.0,0.0),pt(0,
    0,0)})@ 0)(pending(b(0),goToW(b(0),{senLoc(5.0e+1,1.0e+1,5.0),pt(50,10,5)},
    5.0))@ 3)(countLate(b(0),0)@ 0)(visited(b(0),nil)@ 0)(energy(b(0),9.8e+1)@
    2)(caution(b(0),2.0e+1)@ 0)(targetVel(b(0),5.0)@ 0)(vel(b(0),
    3.7416573867699997e-2)@ 2)(wind(0.0,1.0,0.0)@ 0)(targets(b(0),{senLoc(
    1.0e+1,3.0e+1,5.0),pt(10,30,5)};{senLoc(-2.0e+1,5.0e+1,5.0),pt(-20,50,5)};{
    senLoc(-4.0e+1,5.0,5.0),pt(-40,5,5)},{senLoc(5.0e+1,1.0e+1,5.0),pt(50,10,
    5)})@ 3)(lastVisit(b(0),{senLoc(0.0,0.0,0.0),pt(0,0,0)},0.0)@ 0)(
    countVisit(b(0),{senLoc(-4.0e+1,5.0,5.0),pt(-40,5,5)},0)@ 0)(countVisit(b(
    0),{senLoc(-2.0e+1,5.0e+1,5.0),pt(-20,50,5)},0)@ 0)(countVisit(b(0),{
    senLoc(1.0e+1,3.0e+1,5.0),pt(10,30,5)},0)@ 0)(countVisit(b(0),{senLoc(
    5.0e+1,1.0e+1,5.0),pt(50,10,5)},0)@ 0)myHome(b(0),{senLoc(0.0,0.0,0.0),pt(
    0,0,0)})myAlt(b(0),5)) .

       
eq ekb0 =  (clock(3)class(b(0),Bot)class(b(1),Bot)(timeElapsed(
    5.7799379999999996)@ 3)(timeElapsed(5.7887750000000002)@ 3)(rand(0)@ 0)(
    atloc(b(0),{senLoc(6.8340666592100002e-2,6.9917351007500003e-2,
    4.98441123962),pt(0,0,5)})@ 3)(atloc(b(1),{senLoc(-1.7366165295199999e-2,
    -1.4644639566500001e-2,9.8187675476099994),pt(-1,-1,10)})@ 3)(energy(b(0),
    9.6e+1)@ 3)(energy(b(1),9.8e+1)@ 3)(targetVel(b(0),5.0)@ 0)(targetVel(b(1),
    5.0)@ 0)(vel(b(0),4.4721359549999999e-2)@ 3)(vel(b(1),1.00498756211e-1)@
    3)(wind(0.0,1.0,0.0)@ 0)) .

eq lkb1 = getSensors(b(0),ekb0) .
eq lkb2 = proSensors(b(0),lkb0,lkb1) .


op loc : -> Loc .
eq loc = getLoc(b(0),lkb2) .

op pact : -> Action .
eq pact = getPending(b(0),lkb2) .

eq akb0 = sitlAct(b(0),lkb2) .
eq akb1 = doControl(getAct(akb0),getKB(akb0)) .

endm

***(




(tval SITL{
[eI
	| clock(103)class(b(0),Bot)class(b(1),Bot)(timeElapsed(
    2.4395026999999999e+1)@ 103)(timeElapsed(2.4413868999999998e+1)@ 103)(rand(
    0)@ 0)(atloc(b(0),{senLoc(1.9770526885999999e+1,2.12352581024e+1,
    5.1267275810199999),pt(20,21,5)})@ 103)(atloc(b(1),{senLoc(
    8.1026935577400003,-1.9890520095799999e+1,1.0164972305299999e+1),pt(8,-19,
    10)})@ 103)(energy(b(0),4.1e+1)@ 103)(energy(b(1),4.3e+1)@ 103)(targetVel(
    b(0),5.0)@ 0)(targetVel(b(1),5.0)@ 0)(vel(b(0),9.05538513814e-2)@ 103)(vel(
    b(1),3.1622776601700001e-2)@ 103)wind(0.0,1.0,0.0)@ 0]
[b(0): Bot |
  lkb :(clock(103)class(b(0),Bot)class(b(1),Bot)(timeElapsed(
    2.4365072000000001e+1)@ 102)(rand(102)@ 102)(atloc(b(0),{senLoc(
    1.9766757965099998e+1,2.12331218719e+1,5.1281938552900002),pt(20,21,5)})@
    102)(atloc(b(1),{senLoc(0.0,0.0,0.0),pt(0,0,0)})@ 0)(pending(b(0),stop(b(
    0)))@ 103)(countLate(b(0),0)@ 0)(visited(b(0),nil)@ 0)(energy(b(0),4.1e+1)@
    102)(caution(b(0),2.0e+1)@ 0)(targetVel(b(0),5.0)@ 0)(vel(b(0),
    8.1240384046399994e-2)@ 102)(wind(0.0,1.0,0.0)@ 0)(targets(b(0),{senLoc(
    1.0e+1,3.0e+1,5.0),pt(10,30,5)};{senLoc(-2.0e+1,5.0e+1,5.0),pt(-20,50,5)};{
    senLoc(-4.0e+1,5.0,5.0),pt(-40,5,5)},{senLoc(5.0e+1,1.0e+1,5.0),pt(50,10,
    5)})@ 99)(lastVisit(b(0),{senLoc(0.0,0.0,0.0),pt(0,0,0)},0.0)@ 0)(
    countVisit(b(0),{senLoc(-4.0e+1,5.0,5.0),pt(-40,5,5)},0)@ 0)(countVisit(b(
    0),{senLoc(-2.0e+1,5.0e+1,5.0),pt(-20,50,5)},0)@ 0)(countVisit(b(0),{
    senLoc(1.0e+1,3.0e+1,5.0),pt(10,30,5)},0)@ 0)(countVisit(b(0),{senLoc(
    5.0e+1,1.0e+1,5.0),pt(50,10,5)},0)@ 0)myHome(b(0),{senLoc(0.0,0.0,0.0),pt(
    0,0,0)})myAlt(b(0),5)),
  ckb :(class(b(0),Bot)class(b(1),Bot)(atloc(b(0),{senLoc(
    1.9766757965099998e+1,2.12331218719e+1,5.1281938552900002),pt(20,21,5)})@
    102)atloc(b(1),{senLoc(0.0,0.0,0.0),pt(0,0,0)})@ 0),
  evs :(tick @ 0)]
[b(1): Bot |
  lkb :(clock(103)class(b(0),Bot)class(b(1),Bot)(timeElapsed(
    2.4365072000000001e+1)@ 102)(rand(204)@ 102)(atloc(b(0),{senLoc(0.0,0.0,
    0.0),pt(0,0,0)})@ 0)(atloc(b(1),{senLoc(8.1026935577400003,
    -1.9890520095799999e+1,1.0164972305299999e+1),pt(8,-19,10)})@ 102)(pending(
    b(1),land(b(1)))@ 103)(countLate(b(1),0)@ 0)(visited(b(1),nil)@ 0)(energy(
    b(1),4.3e+1)@ 102)(caution(b(1),2.0e+1)@ 0)(targetVel(b(1),5.0)@ 0)(vel(b(
    1),3.1622776601700001e-2)@ 102)(wind(0.0,1.0,0.0)@ 0)(targets(b(1),{senLoc(
    -4.0e+1,-4.0e+1,1.0e+1),pt(-40,-40,10)};{senLoc(-3.5e+1,-5.0,1.0e+1),pt(
    -35,-5,10)};{senLoc(1.0e+1,-3.0e+1,1.0e+1),pt(10,-30,10)},{senLoc(4.0e+1,
    -1.0e+1,1.0e+1),pt(40,-10,10)})@ 100)(lastVisit(b(1),{senLoc(0.0,0.0,0.0),
    pt(0,0,0)},0.0)@ 0)(countVisit(b(1),{senLoc(-4.0e+1,-4.0e+1,1.0e+1),pt(-40,
    -40,10)},0)@ 0)(countVisit(b(1),{senLoc(-3.5e+1,-5.0,1.0e+1),pt(-35,-5,
    10)},0)@ 0)(countVisit(b(1),{senLoc(1.0e+1,-3.0e+1,1.0e+1),pt(10,-30,10)},
    0)@ 0)(countVisit(b(1),{senLoc(4.0e+1,-1.0e+1,1.0e+1),pt(40,-10,10)},0)@
    0)myHome(b(1),{senLoc(0.0,0.0,0.0),pt(0,0,0)})myAlt(b(1),10)),
  ckb :(class(b(0),Bot)class(b(1),Bot)(atloc(b(0),{senLoc(0.0,0.0,0.0),pt(0,0,
    0)})@ 0)atloc(b(1),{senLoc(8.1026935577400003,-1.9890520095799999e+1,
    1.0164972305299999e+1),pt(8,-19,10)})@ 102),
  evs :(tick @ 0)]})
)